---
title: Excel Analysis Report from Luminex xPONENT Raw Data - v 1.0
author: Nick Bild
date: 2016-06-15
version:
  number: 1.0
  name: Initial development
---

Description
--------

The Excel Analysis Report from Luminex xPONENT Raw Data â€“ v 1.0 web app will accept data files generated by the Luminex xPONENT instrument and convert them into an Excel workbook.

Script relationships:

```
form.html
|
-- api.cgi
   |
   -- multiplex_protein_run.pl
   |  |
   |  -- multiplex_protein_excel.pl
   |
   -- status.cgi
```

The general method of interaction between web applications and marburg is described in the "webapp_marburg_execution" documentation folder.

Dependencies
--------

Perl v5 is required.  The following Perl modules are required:

```
Text::CSV
Math::Combinatorics
Excel::Writer::XLSX
```

Software installed on yonggan-Precision-WorkStation-T5400 (192.168.0.16) in /home/yonggan/www/pl/multiplex_protein and marburg (192.168.0.14) in /home/act/software/nickbild/multiplex_protein.

Usage Instructions
--------

* The pipline is available as part of the ORB intranet, and this is the only method of running the pipeline.

[http://192.168.0.16/](http://192.168.0.16/) -> Protein -> Luminex xPONENT Analysis

The following questions will be asked:

* Has the data already been adjusted for the dilution factor?
    - e.g.: Y
* Select data file:
    - select local .csv files
* Select sampleinfo file
    - select sampleinfo file locally, from a location on marburg, or paste the content in a text box

Input Data Format:

The expected input data files are .csv files from the Luminex instrument.  The data files are expected to have the following tables, beginning with the headers (position 1 and 2 in the CSV):

* DataType:,Net MFI
* DataType:,Count	
* DataType:,Result

These tables have the format:

```
Location,Sample,analyte1,analyte2,...,analyteN
```

The following tables, beginning with the headers (position 1 and 2 in the CSV) are also expected:

* DataType:,Avg Result
* DataType:,Control Range - Low
* DataType:,Control Range - High
* DataType:,Standard Expected Concentration
* DataType:,Avg Net MFI
* DataType:,%CV Replicates

These tables have the format:

```
Sample,analyte1,analyte2,...,analyteN
```

Sampleinfo Format:

The sample information must be a tab-delimited text file. It must have a header row, which is the first line. The header row must contain the following columns, in the following order:

1. ORB ID
2. Customer Sample ID
3. Label on Tube
4. Plate
5. Luminex Sample Name
6. Dilution

Optionally, a group column may be included:

7. Group

The "Luminex Sample Name" column must match the sample names in the input files.

Output File:

The output from this application is an Excel workbook. The workbook contains the following tabs:

* Methods-and-Overview - Blank.
* Sample-Information - Contain the sample information uploaded by the user.
* Graphs-pg-per-ml - Blank.
* Sample-Means - Contains data from the "Avg Result" and "%CV Replicates" data tables for the samples. Also includes calculated standard deviations.
* Standards - Contains the data from the "Standard Expected Concentration", and the data from the "Avg Result", "Avg Net MFI" tables for the Standard samples.
* All-Wells - Contains the data from the "Net MFI", "Count", and "Result" tables for all the wells on the plates, which will include Standards, Controls, and Samples (or Unknowns). The "Result" table contains the protin concentration in the units specified in the "Units" data table.
* Raw-Data-Plate-N (where N is 1, 2, etc.) - Contains the data from the XPONENT csv files verbatim.
* Controls - Contains the data from the "Avg Result" table for the controls. It also contains the data from the "Control Range - Low", and "Control Range - High" data tables.
* Statistical-Analysis-Results - If the sample information file contains a "Group" column, then the Excel workbook contains a Statistical-Analysis-Results tab, which has four tables: "Group Means", "Group Fold Changes", "Group Standard Deviations", and "Group Standard Errors". These values (mean, fold changes, standard deviations, and standard errors) are calculated from the values in the Sample Means tab.

Scripts
--------

* form.html - Collect user input.

* api.cgi - Process user input and call multiplex_protein_run.pl on marburg.

* status.cgi - Check staus of analysis and report results to user.

* multiplex_protein_run.pl - Transform input data into desired output files.

* multiplex_protein_excel.pl - Convert output files from multiplex_protein_run.pl into an Excel workbook.

