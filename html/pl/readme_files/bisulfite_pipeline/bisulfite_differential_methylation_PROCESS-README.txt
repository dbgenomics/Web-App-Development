Bisulfiteseq Differential Methylation
Author: Nick Bild
Date: 2016-08-18
Version 1.0: Initial development.

Description
--------

Bisulfiteseq Differential Methylation calculates differential methylation via Fisher's exact test, report significant hyper/hypo methylated locations, and generates heatmaps, pie charts, and bar charts of the results.

Script relationships:

methylkit_fisher.pl
|
-- methylkit_fisher_report.pl
|
-- methylkit_heatmaps.pl
|
-- methylkit_bar-chart.pl

Dependencies
--------

Perl v5 is required.  R version 3.0.1 is required, as well as the "methylKit" library.

Software installed on marburg (192.168.0.14) in /home/act/software/nickbild.

Usage Instructions
--------

Bisulfiteseq Differential Methylation is available via the bisulfiteseq pipeline (note that step numbers may change over time):

10. differential methylation

* Values for the following entries in oap_database.txt will be asked for:

[GENOME_ASSEMBLY]
[METHYLKIT_ANNO]

METHYLKIT_ANNO is generated by the UCSC table browser (https://genome.ucsc.edu/cgi-bin/hgTables).  Select an appropriate genome and assembly, then "Genes and Gene Predictions" for group, and select "BED - browser extensible data" for output format.

* Sampleinfo file

The sampleinfo file must contain contain columns named "Treatment" and "Control" to specify the differential comparisons desired.  A value of "NA" is entered in the column if it is not used in any comparison.  If a sample is included in a comparison, identify the comparison with a unique integer.  If a particular sample is included in the tratment or control groups of multiple comaprisons, the comparison identifiers may be separated with a comma (no spaces).

For example, if you wanted to specify that the first comparison was between treatment SL156402 and control SL156403, a "1" would be entered in the "Treatment" column for SL156402, and a "1" would also be entered in the "Control" column for SL156403.

The sampleinfo file below:

--------
#Sample Name	GSL ID	ORB Enriched Library ID 	Description	Project ID	Group	Control	Treatment
SL156402	4091-CN-0001	AM021301	F GS+ 1	methyltest-1-0616	F-GS	NA	1,3
SL156403	4091-CN-0002	AM021302	F GS+ 2	methyltest-1-0616	F-GS	NA	1,3
SL156404	4091-CN-0003	AM021303	M GS+ 1	methyltest-1-0616	M-GS	1	4
SL156405	4091-CN-0004	AM021304	M GS+ 2	methyltest-1-0616	M-GS	1	4
SL156407	4091-CN-0006	AM021306	F GS- 1	methyltest-1-0616	F	3	2
SL156408	4091-CN-0007	AM021307	F GS- 2	methyltest-1-0616	F	3	2
SL156409	4091-CN-0008	AM021308	M GS- 1	methyltest-1-0616	M	2,4	NA
SL156410	4091-CN-0009	AM021309	M GS- 2	methyltest-1-0616	M	2,4	NA
SL156411	4091-CN-0010	AM021311	H+ MET	methyltest-1-0616	Hm	NA	5
SL156412	4091-CN-0011	AM021312	H- 	methyltest-1-0616	H	5	NA
--------

Would specify these 5 comparisons:

Comparison #	Treatment Samples	Control Samples
------------    -----------------       ---------------
4       SL156404;SL156405      SL156409;SL156410
1       SL156402;SL156403      SL156404;SL156405
3       SL156402;SL156403      SL156407;SL156408
2       SL156407;SL156408      SL156409;SL156410
5       SL156411       SL156412

* Output

Relative to the project directory, the following files will be generated:

methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-nucleo-level-report.txt				-- Differential methylation report, nucleotide level.
methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-tile-level-report.txt				-- Differential methylation report, tile level.
methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-tile-level-report_hyper-hypo.txt			-- Differential methylation report, with hypo/hyper methylated regions noted.
methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-tile-level-report_hyper-hypo_significant.txt		-- Same as above, but filtered for significant regions.
methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-tile-level-report.txt.heatmap.<FEATURE-TYPE>.png	-- Heatmap of number of methylated Cs for a given feature and comparison.
methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-tile-level-report.txt.pie.png			-- Pie chart of number of each feature found in a comparison.
methylkit/diff-methyl-<COMPARISON-NUMBER>-cytosine-tile-level-report_hyper-hypo_significant.txt.barchart.png	-- Per-chromosome bar chart of % of hyper/hypo regions found as compared to all regions found.
methylkit/cytosine-nucleo-level-report.differential.txt							-- cytosine-nucleo-level-report.txt with diff. exp. stats added.
methylkit/cytosine-tile-level-report.differential.txt							-- cytosine-tile-level-report.txt with diff. exp. stats added.

Scripts
--------

* methylkit_fisher.pl - Set up and run methylKit comparisons.

* methylkit_fisher_report.pl - Generate reports based on methylKit data.

* methylkit_heatmaps.pl - Generate heatmaps with R.

* methylkit_bar-chart.pl - Generate bar charts with R.

* bisulfite_add_diff_to_counts.pl - Add diff. exp. stats to counts files.

